# Import data


```{r echo=FALSE}
wine <- read.table("C:/Users/Usuario/OneDrive/Escritorio/Investigacion/data_MFA_WineJurys.csv", 
      header=TRUE, sep=";",dec=".", row.names=1, check.names=FALSE)
```

```{r eval=FALSE}
head(wine)
summary(wine)
```

# Cargamos libreria FactoMineR
```{r}
library(FactoMineR)
```

# AFM sin grupos complementarios
```{r}
res <- MFA(wine[,2:58], group=c(27,15,15), type=rep("s",3), 
           name.group=c("Expert","Student","Consumer"))
```

# AFM con grupos complementarios
```{r}
res <- MFA(wine, group=c(1,27,15,15,60), type=c("n",rep("s",4)), num.group.sup=c(1,5),
           name.group=c("Grade","Expert","Student","Consumer","Appreciation"))
```

resumen de los modelos 

```{r eval=FALSE}
summary(res)
```

resultados de las 2 primeras dimensiones

```{r}
summary(res, ncp=2)
```

# descripcion de las dimensiones
```{r}
dimdesc(res)
```

# grafico de los grupos de las variables
```{r}
plot(res,choix="group",cex=1.2)
```

# grafico de los individuos
```{r}
plot(res, habillage=1)
```

# grafico de las variables
```{r}
plot(res,choix="var", invisible="quanti.sup", title="Graph of the active variables")
```

# Graph with variables selection
```{r}
selection = c(grep("passion",rownames(res$quanti.var$coord),fixed=TRUE),
    grep("Acidity",rownames(res$quanti.var$coord),fixed=TRUE),
    grep("Sweetness",rownames(res$quanti.var$coord),fixed=TRUE))
plot(res,choix="var",select=selection,invisible="quanti.sup")

plot(res,choix="var", invisible="quanti", habillage="none", lab.var=FALSE, 
     title="Graph of the supplementary variables")
```

# Graph with the partial points
```{r}
plot(res,choix="ind", partial="all", invisible="quali", title="Graph with the partial points")
plot(res, cex=0.8, invisible="ind", partial="all", title="Graph of the individuals")
```

# Graph of the partial axes
```{r}
plot(res,choix="axes")
plot(res, cex=0.8, invisible="ind", partial="all")
```

# Color the individuals according to a qualitative variable
```{r}
plot(res, cex=0.8, habillage=1)
```
